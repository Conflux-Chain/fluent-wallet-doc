(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[2915],{52915:function(t,n,r){"use strict";function e(t){var n=[];return t.split("/").forEach((function(t){var r=parseInt(t,10);isNaN(r)||(t.length>1&&"'"===t[t.length-1]&&(r+=2147483648),n.push(r))})),n}function o(t,n){function r(t,e,o){return t>=e.length?o:n(e[t],t).then((function(n){return o.push(n),r(t+1,e,o)}))}return Promise.resolve().then((function(){return r(0,t,[])}))}r.r(n),r.d(n,{default:function(){return v}});var i=r(22226),a=r(35372),u=r.n(a),l=r(48834).Buffer,c=function(t,n,r,e){return new(r||(r=Promise))((function(o,i){function a(t){try{l(e.next(t))}catch(n){i(n)}}function u(t){try{l(e.throw(t))}catch(n){i(n)}}function l(t){var n;t.done?o(t.value):(n=t.value,n instanceof r?n:new r((function(t){t(n)}))).then(a,u)}l((e=e.apply(t,n||[])).next())}))},h=function(t,n){var r,e,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,e&&(o=2&i[0]?e.return:i[0]?e.throw||((o=e.return)&&o.call(e),0):e.next)&&!(o=o.call(e,i[1])).done)return o;switch(e=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,e=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],e=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},s=function(t){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(t,n){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var e,o,i=r.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(e=i.next()).done;)a.push(e.value)}catch(u){o={error:u}}finally{try{e&&!e.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},p=2,g=3,d=4,y=1029,v=function(){function t(t,n,r){void 0===r&&(r="conflux_default_scramble_key"),this.transport=t,this.chainId=n||y,t.decorateAppAPIMethods(this,["getAddress","signTransaction","getAppConfiguration","signPersonalMessage"],r)}return t.prototype.getAddress=function(t,n,r){var o=this,a=e(t),u=l.alloc(1+4*a.length);if(u[0]=a.length,a.forEach((function(t,n){u.writeUInt32BE(t,1+4*n)})),n){var c=l.alloc(4);c.writeUInt32BE(this.chainId),u=l.concat([u,c])}return this.transport.send(224,p,n?1:0,r?1:0,u).then((function(t){var n,e=t[0],a=t.slice(2,1+e).toString("hex"),u=i.format.address("0x"+i.sign.publicKeyToAddress(l.from(a,"hex")).toString("hex"),o.chainId);if(r){var c=t[1+e];n=t.slice(1+e+1,1+e+1+c).toString("hex")}return{publicKey:a,address:u,chainCode:n}}))},t.prototype.signTransaction=function(t,n){return c(this,void 0,void 0,(function(){var r,e,i,a,c,s,f=this;return h(this,(function(h){for(r=u().fromString(t).toPathArray(),e=0,i=l.from(n,"hex"),a=[],s=function(){var t=0===e?149-4*r.length:150,n=e+t>i.length?i.length-e:t,o=l.alloc(0===e?1+4*r.length+n:n);0===e?(o[0]=r.length,r.forEach((function(t,n){o.writeUInt32BE(t,1+4*n)})),i.copy(o,1+4*r.length,e,e+n)):i.copy(o,0,e,e+n),a.push(o),e+=n};e!==i.length;)s();return[2,o(a,(function(t,n){return f.transport.send(224,g,0===n?0:128,0,t).then((function(t){c=t}))})).then((function(){return{v:c.slice(0,1)[0].toString(16),r:c.slice(1,33).toString("hex"),s:c.slice(33,65).toString("hex")}}),(function(t){throw function(t){if(t&&27264===t.statusCode)throw new Error("Missing a parameter. Try enabling blind signature in the app");return t}(t)}))]}))}))},t.prototype.getAppConfiguration=function(){return c(this,void 0,void 0,(function(){var t,n,r,e,o,i,a,u;return h(this,(function(l){switch(l.label){case 0:return[4,this.transport.send(176,1,0,0)];case 1:if(t=l.sent(),n=0,1!==t[n++])throw new Error("getAppAndVersion: format not supported");return r=t[n++],e=t.slice(n,n+=r).toString("ascii"),o=t[n++],i=t.slice(n,n+=o).toString("ascii"),a=t[n++],u=t.slice(n,n+=a),[2,{name:e,version:i,flags:u}]}}))}))},t.prototype.signPersonalMessage=function(t,n){for(var r,i=this,a=e(t),u=0,c=l.from(n,"hex"),h=[],s=function(){var t=0===u?149-4*a.length-4-4:150,n=u+t>c.length?c.length-u:t,r=l.alloc(0===u?1+4*a.length+4+4+n:n);0===u?(r[0]=a.length,a.forEach((function(t,n){r.writeUInt32BE(t,1+4*n)})),r.writeUInt32BE(f.chainId,1+4*a.length),r.writeUInt32BE(c.length,1+4*a.length+4),c.copy(r,1+4*a.length+4+4,u,u+n)):c.copy(r,0,u,u+n),h.push(r),u+=n},f=this;u!==c.length;)s();return o(h,(function(t,n){return i.transport.send(224,d,0===n?0:128,0,t).then((function(t){r=t}))})).then((function(){return{v:r[0],r:r.slice(1,33).toString("hex"),s:r.slice(33,65).toString("hex")}}))},t.prototype.pathToBuffer=function(t){var n=t.split("/").map((function(t){return t.endsWith("'")||t.endsWith("h")?t:t+"'"})).join("/"),r=u().fromString(n).toPathArray();return this.serializePath(r)},t.prototype.serializePath=function(t){var n,r,e=l.alloc(1+4*t.length);e.writeUInt8(t.length,0);try{for(var o=s(t.entries()),i=o.next();!i.done;i=o.next()){var a=f(i.value,2),u=a[0],c=a[1];e.writeUInt32BE(c,1+4*u)}}catch(h){n={error:h}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return e},t}()},35372:function(t){const n=2147483648;var r=function(t){if(!Array.isArray(t))throw new Error("Input must be an Array");if(0===t.length)throw new Error("Path must contain at least one level");for(var n=0;n<t.length;n++)if("number"!=typeof t[n])throw new Error("Path element is not a number");this.path=t};r.validatePathArray=function(t){try{return r.fromPathArray(t),!0}catch(n){return!1}},r.validateString=function(t,n){try{return r.fromString(t,n),!0}catch(e){return!1}},r.fromPathArray=function(t){return new r(t)},r.fromString=function(t,e){if(/^m\//i.test(t))t=t.slice(2);else if(e)throw new Error("Root element is required");for(var o=t.split("/"),i=new Array(o.length),a=0;a<o.length;a++){var u=/(\d+)([hH\']?)/.exec(o[a]);if(null===u)throw new Error("Invalid input");if(i[a]=parseInt(u[1],10),i[a]>=n)throw new Error("Invalid child index");if("h"===u[2]||"H"===u[2]||"'"===u[2])i[a]+=n;else if(0!=u[2].length)throw new Error("Invalid modifier")}return new r(i)},r.prototype.toPathArray=function(){return this.path},r.prototype.toString=function(t,r){for(var e=new Array(this.path.length),o=0;o<this.path.length;o++){var i=this.path[o];e[o]=i&n?(i&~n)+(r?"h":"'"):i}return(t?"":"m/")+e.join("/")},r.prototype.inspect=function(){return"BIPPath <"+this.toString()+">"},t.exports=r}}]);