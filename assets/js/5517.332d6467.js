(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[5517],{35517:function(t,n,r){"use strict";var e=r(48834).Buffer,o=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))((function(o,i){function a(t){try{h(e.next(t))}catch(n){i(n)}}function u(t){try{h(e.throw(t))}catch(n){i(n)}}function h(t){var n;t.done?o(t.value):(n=t.value,n instanceof r?n:new r((function(t){t(n)}))).then(a,u)}h((e=e.apply(t,n||[])).next())}))},i=this&&this.__generator||function(t,n){var r,e,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,e&&(o=2&i[0]?e.return:i[0]?e.throw||((o=e.return)&&o.call(e),0):e.next)&&!(o=o.call(e,i[1])).done)return o;switch(e=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,e=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(t,a)}catch(u){i=[6,u],e=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__values||function(t){var n="function"==typeof Symbol&&Symbol.iterator,r=n&&t[n],e=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&e>=t.length&&(t=void 0),{value:t&&t[e++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},u=this&&this.__read||function(t,n){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var e,o,i=r.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(e=i.next()).done;)a.push(e.value)}catch(u){o={error:u}}finally{try{e&&!e.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},h=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n.__esModule=!0;var s=r(54682),c=r(22226),l=h(r(35372)),f=2,p=3,d=4,g=1029,y=function(){function t(t,n,r){void 0===r&&(r="conflux_default_scramble_key"),this.transport=t,this.chainId=n||g,t.decorateAppAPIMethods(this,["getAddress","signTransaction","getAppConfiguration","signPersonalMessage"],r)}return t.prototype.getAddress=function(t,n,r){var o=this,i=(0,s.splitPath)(t),a=e.alloc(1+4*i.length);if(a[0]=i.length,i.forEach((function(t,n){a.writeUInt32BE(t,1+4*n)})),n){var u=e.alloc(4);u.writeUInt32BE(this.chainId),a=e.concat([a,u])}return this.transport.send(224,f,n?1:0,r?1:0,a).then((function(t){var n,i=t[0],a=t.slice(2,1+i).toString("hex"),u=c.format.address("0x"+c.sign.publicKeyToAddress(e.from(a,"hex")).toString("hex"),o.chainId);if(r){var h=t[1+i];n=t.slice(1+i+1,1+i+1+h).toString("hex")}return{publicKey:a,address:u,chainCode:n}}))},t.prototype.signTransaction=function(t,n){return o(this,void 0,void 0,(function(){var r,o,a,u,h,c,f=this;return i(this,(function(i){for(r=l.default.fromString(t).toPathArray(),o=0,a=e.from(n,"hex"),u=[],c=function(){var t=0===o?149-4*r.length:150,n=o+t>a.length?a.length-o:t,i=e.alloc(0===o?1+4*r.length+n:n);0===o?(i[0]=r.length,r.forEach((function(t,n){i.writeUInt32BE(t,1+4*n)})),a.copy(i,1+4*r.length,o,o+n)):a.copy(i,0,o,o+n),u.push(i),o+=n};o!==a.length;)c();return[2,(0,s.foreach)(u,(function(t,n){return f.transport.send(224,p,0===n?0:128,0,t).then((function(t){h=t}))})).then((function(){return{v:h.slice(0,1)[0].toString(16),r:h.slice(1,33).toString("hex"),s:h.slice(33,65).toString("hex")}}),(function(t){throw function(t){if(t&&27264===t.statusCode)throw new Error("Missing a parameter. Try enabling blind signature in the app");return t}(t)}))]}))}))},t.prototype.getAppConfiguration=function(){return o(this,void 0,void 0,(function(){var t,n,r,e,o,a,u,h;return i(this,(function(i){switch(i.label){case 0:return[4,this.transport.send(176,1,0,0)];case 1:if(t=i.sent(),n=0,1!==t[n++])throw new Error("getAppAndVersion: format not supported");return r=t[n++],e=t.slice(n,n+=r).toString("ascii"),o=t[n++],a=t.slice(n,n+=o).toString("ascii"),u=t[n++],h=t.slice(n,n+=u),[2,{name:e,version:a,flags:h}]}}))}))},t.prototype.signPersonalMessage=function(t,n){for(var r,o=this,i=(0,s.splitPath)(t),a=0,u=e.from(n,"hex"),h=[],c=function(){var t=0===a?149-4*i.length-4-4:150,n=a+t>u.length?u.length-a:t,r=e.alloc(0===a?1+4*i.length+4+4+n:n);0===a?(r[0]=i.length,i.forEach((function(t,n){r.writeUInt32BE(t,1+4*n)})),r.writeUInt32BE(l.chainId,1+4*i.length),r.writeUInt32BE(u.length,1+4*i.length+4),u.copy(r,1+4*i.length+4+4,a,a+n)):u.copy(r,0,a,a+n),h.push(r),a+=n},l=this;a!==u.length;)c();return(0,s.foreach)(h,(function(t,n){return o.transport.send(224,d,0===n?0:128,0,t).then((function(t){r=t}))})).then((function(){return{v:r[0],r:r.slice(1,33).toString("hex"),s:r.slice(33,65).toString("hex")}}))},t.prototype.pathToBuffer=function(t){var n=t.split("/").map((function(t){return t.endsWith("'")||t.endsWith("h")?t:t+"'"})).join("/"),r=l.default.fromString(n).toPathArray();return this.serializePath(r)},t.prototype.serializePath=function(t){var n,r,o=e.alloc(1+4*t.length);o.writeUInt8(t.length,0);try{for(var i=a(t.entries()),h=i.next();!h.done;h=i.next()){var s=u(h.value,2),c=s[0],l=s[1];o.writeUInt32BE(l,1+4*c)}}catch(f){n={error:f}}finally{try{h&&!h.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},t}();n.default=y},54682:function(t,n){"use strict";n.__esModule=!0,n.asyncWhile=n.doIf=n.foreach=n.eachSeries=n.splitPath=n.defer=void 0,n.defer=function(){var t,n,r=new Promise((function(r,e){t=r,n=e}));if(!t||!n)throw"defer() error";return{promise:r,resolve:t,reject:n}},n.splitPath=function(t){var n=[];return t.split("/").forEach((function(t){var r=parseInt(t,10);isNaN(r)||(t.length>1&&"'"===t[t.length-1]&&(r+=2147483648),n.push(r))})),n},n.eachSeries=function(t,n){return t.reduce((function(t,r){return t.then((function(){return n(r)}))}),Promise.resolve())},n.foreach=function(t,n){function r(t,e,o){return t>=e.length?o:n(e[t],t).then((function(n){return o.push(n),r(t+1,e,o)}))}return Promise.resolve().then((function(){return r(0,t,[])}))},n.doIf=function(t,n){return Promise.resolve().then((function(){if(t)return n()}))},n.asyncWhile=function(t,n){return Promise.resolve([]).then((function r(e){return t()?n().then((function(t){return e.push(t),r(e)})):e}))}},35372:function(t){const n=2147483648;var r=function(t){if(!Array.isArray(t))throw new Error("Input must be an Array");if(0===t.length)throw new Error("Path must contain at least one level");for(var n=0;n<t.length;n++)if("number"!=typeof t[n])throw new Error("Path element is not a number");this.path=t};r.validatePathArray=function(t){try{return r.fromPathArray(t),!0}catch(n){return!1}},r.validateString=function(t,n){try{return r.fromString(t,n),!0}catch(e){return!1}},r.fromPathArray=function(t){return new r(t)},r.fromString=function(t,e){if(/^m\//i.test(t))t=t.slice(2);else if(e)throw new Error("Root element is required");for(var o=t.split("/"),i=new Array(o.length),a=0;a<o.length;a++){var u=/(\d+)([hH\']?)/.exec(o[a]);if(null===u)throw new Error("Invalid input");if(i[a]=parseInt(u[1],10),i[a]>=n)throw new Error("Invalid child index");if("h"===u[2]||"H"===u[2]||"'"===u[2])i[a]+=n;else if(0!=u[2].length)throw new Error("Invalid modifier")}return new r(i)},r.prototype.toPathArray=function(){return this.path},r.prototype.toString=function(t,r){for(var e=new Array(this.path.length),o=0;o<this.path.length;o++){var i=this.path[o];e[o]=i&n?(i&~n)+(r?"h":"'"):i}return(t?"":"m/")+e.join("/")},r.prototype.inspect=function(){return"BIPPath <"+this.toString()+">"},t.exports=r}}]);